"use strict";var authLogin={apiUrl:"",def:"",config:{},onPost:!1,dev:function a(){var e=navigator.userAgent.toLowerCase(),t=/micromessenger/i.test(e),o=/qq/i.test(e),i=/godlike/i.test(e),n=/weibo/i.test(e),c=/line/i.test(e),l=/twitter/i.test(e),r=function(){var a=navigator.userAgent||navigator.vendor||window.opera;return a.indexOf("FBAN")>-1||a.indexOf("FBAV")>-1}(),a="";return t?a="weixin":i?a="":o?a="qq":n?a="weibo":r?a="facebook":c?a="line":l&&(a="twitter"),a},urlps:function(a){var e,t,o,i,n,c,l,r,g,s="";for(a.indexOf("#")>=0&&(s=a.substr(a.indexOf("#")+1,a.length),a=a.replace("#"+s,"")),e="",a.indexOf("?")>=0&&(e=a.substr(a.indexOf("?")+1,a.length),a=a.replace("?"+e,"")),t=a,o=e.split("&"),i=o.length,l=[],r=[],n=0;i>n;n++)c=o[n].split("="),l[c[0]]=c[1];for(g=s.split("&"),i=g.length,n=0;i>n;n++)c=g[n].split("="),r[c[0]]=c[1];return{lists:function(){return l},data:function(a,e){if("undefined"==typeof e){var t=l[a.toLowerCase()];return"undefined"==typeof t?"":t}l[a]=e},hash:function(a,e){if("undefined"==typeof e){var t=r[a.toLowerCase()];return"undefined"==typeof t?"":t}r[a]=e},getHash:function(){var a,e,t=[];for(a in r)r[a]&&t.push(a+"="+r[a]);return e="",t.length>0&&(e=t.join("&")),e},url:function(){var a,e,o,i=[];for(a in l)l[a]&&i.push(a+"="+l[a]);e="",i.length>0&&(e="?"+i.join("&")),i=[];for(a in r)r[a]&&i.push(a+"="+r[a]);return o="",i.length>0&&(o="#"+i.join("&")),t+""+e+o}}},check:function(a){if(!a)return void console.log("\u8bf7\u914d\u7f6e\u5f53\u524d\u4ea7\u54c1\u4ee3\u53f7");switch(a){case"hy":authLogin.config.weiboAppid=3105659870,authLogin.config.fbAppid=362581687527744,authLogin.config.fbCallback="https://www.knivesout.jp/callback/",authLogin.config.lineAppid=1590337385,authLogin.config.lineCallback="https://www.knivesout.jp/callback/",authLogin.config.ttCallback="https://www.knivesout.jp/callback/";break;case"ssr":authLogin.config.weiboAppid=1581692899,authLogin.config.fbAppid=0xa582d3866800,authLogin.config.fbCallback="https://www.onmyoji-card.com/callback/",authLogin.config.lineAppid=1655092783,authLogin.config.lineCallback="https://www.onmyoji-card.com/callback/",authLogin.config.ttCallback="https://www.onmyoji-card.com/callback/";break;case"mrzh":authLogin.config.weiboAppid=1581692899,authLogin.config.fbAppid=0x40f20d6b7e3c6,authLogin.config.fbCallback="https://www.lifeafter.game/callback/",authLogin.config.ttCallback="https://www.lifeafter.game/callback/";break;case"yys":authLogin.config.weiboAppid=3084015878,authLogin.config.fbAppid=723517304476519,authLogin.config.fbCallback="https://www.onmyojigame.jp/callback/",authLogin.config.ttCallback="https://www.onmyojigame.jp/callback/";break;case"infinitelagrange":authLogin.config.fbAppid=513605446085539,authLogin.config.lineAppid=1656114565,authLogin.config.lineCallback="https://www.infinitelagrange.com/callback/",authLogin.config.fbCallback="https://www.infinitelagrange.com/callback/",authLogin.config.ttCallback="https://www.infinitelagrange.com/callback/";break;case"eclipse":authLogin.config.fbAppid=446604786479590,authLogin.config.fbCallback="https://www.eclipse.games/callback/",authLogin.config.ttCallback="https://www.eclipse.games/callback/";break;case"stzb":authLogin.config.weiboAppid=1581692899,authLogin.config.ttCallback="https://www.daisangoku.com/callback/";break;case"xy3d":authLogin.config.weiboAppid=2756851256;break;case"f7":authLogin.config.ttCallback="https://www.forevernana.com/callback/";break;case"g93":authLogin.config.weiboAppid=1581692899,authLogin.config.fbAppid=299888623969620,authLogin.config.fbCallback="https://www.supermechachampions.com/callback/",authLogin.config.lineAppid=1653370481,authLogin.config.lineCallback="https://www.supermechachampions.com/callback/",authLogin.config.ttCallback="https://www.supermechachampions.com/callback/";break;case"g93tw":authLogin.config.weiboAppid=1581692899,authLogin.config.fbAppid=315324852516335,authLogin.config.fbCallback="https://www.supermechachampions.com/callback/",authLogin.config.lineAppid=1653370481,authLogin.config.lineCallback="https://www.supermechachampions.com/callback/",authLogin.config.ttCallback="https://www.supermechachampions.com/callback/";break;case"4wdgame":authLogin.config.fbAppid=578961710159869,authLogin.config.fbCallback="https://www.4wdgame.com/callback/";break;case"eve":authLogin.config.fbAppid=371081370126685,authLogin.config.fbCallback="https://www.eveechoes.com/callback/",authLogin.config.ttCallback="https://www.eveechoes.com/callback/";break;case"g96":authLogin.config.fbAppid=491526771661911,authLogin.config.fbCallback="https://www.lotr-risetowar.com/callback/",authLogin.config.ttCallback="https://www.lotr-risetowar.com/callback/";break;case"ma96":authLogin.config.fbAppid=0xefe5588d42b8,authLogin.config.fbCallback="https://www.neverafter.tw/callback/",authLogin.config.ttCallback="https://www.neverafter.tw/callback/";break;case"g92":authLogin.config.fbAppid=525634611326844,authLogin.config.lineAppid=1655982507,authLogin.config.lineCallback="https://www.harrypottermagicawakened.com/callback/",authLogin.config.fbCallback="https://www.harrypottermagicawakened.com/callback/",authLogin.config.ttCallback="https://www.harrypottermagicawakened.com/callback/";break;case"id5":authLogin.config.fbAppid=578777605819697,authLogin.config.fbCallback="https://www.identityvgame.com/callback/",authLogin.config.lineAppid=1605075601,authLogin.config.lineCallback="https://www.identityvgame.com/callback/",authLogin.config.ttCallback="https://www.identityvgame.com/callback/";break;case"ma100":authLogin.config.fbAppid=430179884723572,authLogin.config.fbCallback="https://www.dbdmobile-sea.com/callback/",authLogin.config.lineAppid=1656940814,authLogin.config.lineCallback="https://www.dbdmobile-sea.com/callback/",authLogin.config.ttCallback="https://www.dbdmobile-sea.com/callback/";break;case"ma135":authLogin.config.ttCallback="https://www.clovertheater.jp/callback/";break;default:authLogin.config.weiboAppid=1581692899}var e=authLogin.urlps(location.href),t=authLogin.dev();switch(authLogin.def&&(t=authLogin.def),t){case"weixin":case"qq":case"weibo":case"facebook":case"line":return e.data("code")?!0:!1;case"twitter":return e.data("oauth_token")?!0:!1}},go:function(a){var e=authLogin.urlps(location.href),t=authLogin.dev();authLogin.def&&(t=authLogin.def);var o="";if(void 0!=typeof a)for(var i in a)"scope"==i?o=a[i]:e.data(i,a[i]);e.data("code",""),e.data("oauth_token",""),e.data("oauth_verifier",""),e.data("state",""),e.data("rurl",""),e.data("r",""),e.data("nie","");var n=e.url(),c="";switch(t){case"weixin":if(o||(o="snsapi_userinfo"),"game.163.com"==location.host)c="https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx85f583832dbd07e9&redirect_uri="+encodeURIComponent(n)+"&response_type=code&scope="+o+"&state=163#wechat_redirect";else{var l="https://webapi.163.com/weixin/";n=escape(n),n=encodeURIComponent(l+"?source_uri="+n),c="https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx85f583832dbd07e9&redirect_uri="+n+"&response_type=code&scope="+o+"&state=163#wechat_redirect"}location.href=c;break;case"qq":var r=encodeURIComponent("https://game.163.com/qqcallback/?u="+encodeURIComponent(n));c="https://graph.qq.com/oauth2.0/authorize?response_type=code&client_id=101465632&redirect_uri="+r+"&scope=get_user_info",location.href=c;break;case"weibo":n="https://game.163.com/weibo/callback/?link="+encodeURIComponent(n),n=encodeURIComponent(n),c="https://api.weibo.com/oauth2/authorize?response_type=code&client_id="+authLogin.config.weiboAppid+"&response_type=code&redirect_uri="+n,location.href=c;break;case"facebook":if(!authLogin.config.fbAppid)return void console.log("\u5f53\u524d\u4ea7\u54c1\u6ca1\u6709\u914d\u7f6eFacebook\u7684\u6388\u6743\u8d26\u53f7");var g=encodeURIComponent(n);c="https://www.facebook.com/dialog/oauth?client_id="+authLogin.config.fbAppid+"&redirect_uri="+encodeURIComponent(authLogin.config.fbCallback)+"&scope=public_profile,email&state="+g,location.href=c;break;case"line":if(!authLogin.config.lineAppid)return void console.log("\u5f53\u524d\u4ea7\u54c1\u6ca1\u6709\u914d\u7f6eLine\u7684\u6388\u6743\u8d26\u53f7");var g=encodeURIComponent(n);c="https://access.line.me/oauth2/v2.1/authorize?response_type=code&client_id="+authLogin.config.lineAppid+"&redirect_uri="+encodeURIComponent(authLogin.config.lineCallback)+"&scope=profile%20openid&state="+g,location.href=c;break;case"twitter":if(!authLogin.apiUrl)return void console.log("miss apiUrl for twitter");if(authLogin.onPost)return;authLogin.onPost=!0,n=authLogin.config.ttCallback+"?link="+encodeURIComponent(encodeURIComponent(n)),$.ajax({url:authLogin.apiUrl,data:{app_id:"1508290471921852416",oauth_callback:n},dataType:"jsonp",success:function(a){authLogin.onPost=!1,1==a.success?location.href="https://api.twitter.com/oauth/authorize?oauth_token="+a.oauth_token:200==a.code&&a.data?location.href="https://api.twitter.com/oauth/authorize?oauth_token="+a.data:alert(a.msg)},error:function(){authLogin.onPost=!1,alert("network error")}})}},subscribemsg:function(a){if(a||(a={}),"undefined"==typeof a.scene&&(a.scene=0),"undefined"==typeof a.template_id&&(a.template_id="ztU3MvdeFsEXzSUC85sF4awRKql8pxL5_bp4bdA8sf8"),"undefined"==typeof a.link){var e=authLogin.urlps(location.href);e.data("code",""),e.data("oauth_token",""),e.data("oauth_verifier",""),e.data("state",""),e.data("rurl",""),e.data("r",""),e.data("nie","");var t=e.url();a.link="https://game.163.com/callback/subscribemsg.html?link="+encodeURIComponent(t)}location.href="https://mp.weixin.qq.com/mp/subscribemsg?action=get_confirm&appid=wx85f583832dbd07e9&scene="+a.scene+"&template_id="+a.template_id+"&redirect_url="+encodeURIComponent(a.link)+"&reserved=163#wechat_redirect"},data:function(a){function e(a){var e=authLogin.urlps(location.href),t=authLogin.dev()||authLogin.def,n=e.data("page_key"),c=e.data("share_key"),l="",r="",g={page_key:n,need_userinfo:1};switch(c&&(g={share_key:c,need_userinfo:1}),t){case"weixin":l=e.data("code"),g.code=l,r="wx/login";break;case"qq":l=e.data("code"),g.code=l,g.redirect_uri=decodeURIComponent(e.data("rurl")),r="qq/login";break;case"weibo":l=e.data("code"),g.code=l,g.redirect_uri="https://game.163.com/weibo/callback/",r="weibo/login";break;case"facebook":l=e.data("code"),g.code=l,g.redirect_uri=authLogin.config.fbCallback,r="fb/login";break;case"line":l=e.data("code"),g.code=l,g.redirect_uri=authLogin.config.lineCallback,r="line/login";break;case"twitter":l=e.data("oauth_token"),g.oauth_token=l,g.oauth_verifier=e.data("oauth_verifier"),r="twitter/login"}$.ajax({url:i+r,data:g,dataType:"jsonp",success:function(e){if(1==e.success)a(e);else{if(!o)return;e.msg||(e.msg=e.error),-1!=e.msg.indexOf("invalid")?authLogin.go():"\u65e0\u6548\u7684Code\uff1a"==e.msg?authLogin.go():-1!=e.msg.toLowerCase().indexOf("code")?authLogin.go():-1!=e.msg.toLowerCase().indexOf("req_id")?authLogin.go():-1!=e.msg.toLowerCase().indexOf("\u4fe1\u606f\u5f02\u5e38")?authLogin.go():-1!=e.msg.toLowerCase().indexOf("failed")?authLogin.go():-1!=e.msg.toLowerCase().indexOf("error")?authLogin.go():alert(e.msg)}},error:function(){alert("\u7f51\u7edc\u4fe1\u53f7\u4e0d\u597d\uff0c\u8bf7\u5237\u65b0\u518d\u8bd5")}})}var t=a.pro||"",o=a.loginErrorAutoJump,i=a.apiUrl,n=authLogin.dev();n||(authLogin.def=a.def||"weibo"),authLogin.apiUrl=i+"twitter/request_token",authLogin.check(t)?("function"==typeof a.authCallback&&a.authCallback(),e(function(e){"function"==typeof a.authApiCallback&&a.authApiCallback(e)})):authLogin.go()}};