"use strict";nie.define("Index",function(){function t(){window.playBtnStatus||(u.attr("data-status","on"),m.get(0).play())}function e(){window.playBtnStatus&&(u.attr("data-status","off"),m.get(0).pause())}var o=(window.location.origin.indexOf("test")>-1,""),n=ca.fn.queryString("page_key"),a=0,i=0,r="",c=!1,s=!!n,d=$.cookie("token"),l=$.cookie("uuid"),p={title:$("#share_title").html(),link:window.location.origin+window.location.pathname,imgurl:$("#share_img").attr("src"),desc:$("#share_desc").html()},u=$(".bgm-btn"),m=$("#bgmBom"),g=!0;$("body").on("click",function(){g&&(t(),g=!1)});var f,h;"undefined"!=typeof document.hidden?(f="hidden",h="visibilitychange"):"undefined"!=typeof document.msHidden?(f="msHidden",h="msvisibilitychange"):"undefined"!=typeof document.webkitHidden&&(f="webkitHidden",h="webkitvisibilitychange");var w=!1;document.addEventListener(h,function(){var o=document[f];o?window.playBtnStatus&&(w=!0,e()):!window.playBtnStatus&&w&&(w=!1,t())});var v=function(t){t.addClass("on").siblings().removeClass("on")},b=function(t){t.addClass("on")},k=function(t){t.removeClass("on")},x=function(t){b($(".pop.pop-"+t))},y=function(t){if(t){var e=$(".pop.pop-"+t);k(e)}else k($(".pop"));$(".pop-live .live-box").html("")},A={1:{img:"https://www.eveechoes.com/pc/zt/20220805102310//img/pop/img-1_85a9abb.png",name:"\u6280\u80fd\u70b910,000",enname:"Skill Point 10,000",showimg:"https://www.eveechoes.com/pc/zt/20220805102310//img/icon-1_40e16e5.png",showimgOn:"https://www.eveechoes.com/pc/zt/20220805102310//img/icon-1-on_7d6edf8.png"},2:{img:"https://www.eveechoes.com/pc/zt/20220805102310//img/pop/img-2_7aa6a39.png",name:"\u6280\u80fd\u70b920,000",enname:"Skill Point 20,000",showimg:"https://www.eveechoes.com/pc/zt/20220805102310//img/icon-2_8a8b303.png",showimgOn:"https://www.eveechoes.com/pc/zt/20220805102310//img/icon-2-on_5844a79.png"},3:{img:"https://www.eveechoes.com/pc/zt/20220805102310//img/pop/img-3_93b16a9.png",name:"\u8bd5\u9a8c\u6027\u6b66\u5668\uff1a\u8f83\u9ad8\u4ef7\u503c",enname:"Experimental Weapon",showimg:"https://www.eveechoes.com/pc/zt/20220805102310//img/icon-bx_3672da4.png",showimgOn:"https://www.eveechoes.com/pc/zt/20220805102310//img/icon-bx-on_efe0326.png"}},C={1:{img:"https://www.eveechoes.com/pc/zt/20220805102310//img/pop/img-com_8b3c79e.png",name:"1w\u6280\u80fd\u70b9+1w\u5fe0\u8bda\u70b9",enname:"10k Skill Point and 10k Loyalty Point",code:""},2:{img:"https://www.eveechoes.com/pc/zt/20220805102310//img/pop/img-com_8b3c79e.png",name:"\u8bd5\u9a8c\u6027\u6b66\u5668\uff1b\u4f4e\u4ef7\u503c",enname:"Experimental Weapon",code:""},3:{img:"https://www.eveechoes.com/pc/zt/20220805102310//img/pop/img-com_8b3c79e.png",name:"\u6d82\u88c5\u793c\u5305-\u968f\u673a\u4e00\u4e2a\u6d82\u88c5\u7ef4\u53ef\u7c73",enname:"Random Skin Safe",code:""}},_={init:function(){var t=this;this.getNumber(),this.countTime(),this.closePop(),this.bindClickFn(),this.swiperAll(),this.openShare(),this.windowAll(),n?($(".master").removeClass("on"),$(".guest").addClass("on"),t.getSharerInfo()):($(".master").addClass("on"),$(".guest").removeClass("on")),d?t.viewUserInfo():(ca.fn.queryString("code")||ca.fn.queryString("oauth_token"))&&t.authFn()},authFn:function(t){function e(){function t(t,e){Interface.fn.twLoginApi(t,e,"https://www.eveechoes.com/callback/",function(t){console.log("twLoginApi"),o.shareLoginReport(t,a),o.setCookies(t),o.viewUserInfo()},function(t){o.errFn2(t)})}function e(t,e){Interface.fn.fbLoginApi(t,e,function(t){console.log("fbLoginApi"),o.shareLoginReport(t,a),o.setCookies(t),o.viewUserInfo()},function(t){o.errFn2(t)})}var n=authLogin.urlps(location.href),a=authLogin.def,i=n.data("page_key"),r=n.data("share_key"),c={page_key:i,need_userinfo:1};switch(r&&(c={share_key:r,need_userinfo:1}),a){case"facebook":c.code=n.data("code"),c.redirect_uri="https://www.eveechoes.com/callback/",e(c.code,c.redirect_uri);break;case"twitter":c.oauth_token=n.data("oauth_token"),c.oauth_verifier=n.data("oauth_verifier"),t(c.oauth_token,c.oauth_verifier)}}var o=this;console.log(commonAction);var n=ca.remote._urlRoot,a=authLogin.dev();a||(authLogin.def="twitter"),t&&(authLogin.def=t),authLogin.apiUrl=n+"/twitter/getToken",d?o.viewUserInfo():(ca.fn.queryString("oauth_token")?authLogin.def="twitter":ca.fn.queryString("code")&&(authLogin.def="facebook"),authLogin.check("eve")?e():(o.clearCookie(),authLogin.go()))},viewUserInfo:function(){var t=this;l=$.cookie("uuid"),d=$.cookie("token"),localStorage.getItem("ktBtn")&&$(".btn-support").click(),Interface.fn.userinfoApi(function(e){console.log("\u4e2a\u4eba\u9875\u4fe1\u606f\uff1a",e),t.initUserInfo(e)},function(e){t.errFn(e)})},initUserInfo:function(t){var e=this;o=t.data.code,a=t.data.num,i=t.data.total,r=t.data.nickName,c=t.data.isShare,t.data.isShare&&$(".process.share").addClass("on"),$(".j-mynum").text(a?a:0),e.getMyAwardFn(),e.getHelpLog()},backMasterPage:function(){s=!1,$(".master").addClass("on"),$(".guest").removeClass("on")},getNumber:function(){var t=this;Interface.fn.getNumberApi(function(t){var e=t.data.num,o=t.data.code1;o&&(C[1].code=o);var n=t.data.code2;n&&(C[2].code=n);var a=t.data.code3;a&&(C[3].code=a),$(".xing-bg").attr("data-num",e),e>=3e5?($(".xing-bg .bxs .bx").eq(0).attr("data-status",1),$(".xing-bg .bxs .bx").eq(1).attr("data-status",1),$(".xing-bg .bxs .bx").eq(2).attr("data-status",1),$(".xing-bg .txts .w").eq(0).addClass("on"),$(".xing-bg .txts .w").eq(1).addClass("on"),$(".xing-bg .txts .w").eq(2).addClass("on")):e>=1e5&&3e5>e?($(".xing-bg .bxs .bx").eq(0).attr("data-status",1),$(".xing-bg .bxs .bx").eq(1).attr("data-status",1),$(".xing-bg .bxs .bx").eq(2).attr("data-status",0),$(".xing-bg .txts .w").eq(0).addClass("on"),$(".xing-bg .txts .w").eq(1).addClass("on"),$(".xing-bg .txts .w").eq(2).removeClass("on")):e>=5e4&&1e5>e?($(".xing-bg .bxs .bx").eq(0).attr("data-status",1),$(".xing-bg .bxs .bx").eq(1).attr("data-status",0),$(".xing-bg .bxs .bx").eq(2).attr("data-status",0),$(".xing-bg .txts .w").eq(0).addClass("on"),$(".xing-bg .txts .w").eq(1).removeClass("on"),$(".xing-bg .txts .w").eq(2).removeClass("on")):($(".xing-bg .bxs .bx").eq(0).attr("data-status",0),$(".xing-bg .bxs .bx").eq(1).attr("data-status",0),$(".xing-bg .bxs .bx").eq(2).attr("data-status",0),$(".xing-bg .txts .w").eq(0).removeClass("on"),$(".xing-bg .txts .w").eq(1).removeClass("on"),$(".xing-bg .txts .w").eq(2).removeClass("on"))},function(e){t.errFn(e)})},noAward:!0,getMyAwardFn:function(){var t=this;Interface.fn.drawRecordApi(function(e){console.log("drawRecordApi",e);var o=e.data;if(!o.length)return void(t.noAward=!0);t.noAward=!1;var n="";$.each(o,function(t,e){var o="";o=e.itemName.indexOf("10000")>-1?1:e.itemName.indexOf("20000")>-1?2:3;var a=A[o];n+='<div class="item">                        <div class="l">                            <img src="'+a.img+'" />                        </div>                        <div class="r">                            <div class="t">'+a.enname+'</div>                            <div class="c bigwrite">Redeem Code</div>                            <div class="inputbox">                                <div class="ipt">                                    <input type="text" class="award-code" readonly value="'+e.keyCode+'" />                                </div>                                <a href="javascript:;" class="copy-btn" data-code="'+e.keyCode+'"></a>                            </div>                        </div>                    </div>'}),$(".j-awardList").html(n)},function(e){t.errFn(e)})},getHelpLog:function(){var t=this,e=$(".processbox .process.invit");Interface.fn.helpListApi(function(t){console.log("helpListApi",t);var o=t.data;o.length&&$.each(o,function(t,o){e.eq(t).find(".head .img").html('<img src="'+o.headUrl+'" alt="'+o.nickName+'"/>'),e.eq(t).addClass("on")})},function(e){t.errFn(e)})},getSharerInfo:function(){var t=this;Interface.fn.getCodeInfoApi(n,function(t){console.log("getCodeInfoApi",t),t.data.headUrl&&$(".k-headimg").attr("src",t.data.headUrl),t.data.nickName&&$(".k-nickName").text(t.data.nickName)},function(e){t.errFn(e)})},bindClickFn:function(){var i=this;$(".bgm-btn").on("click",function(){var o=$(this).attr("data-status");"on"==o?e():t()}),$(".authbtn").on("click",function(){var t=$(this).attr("data-auth");localStorage.setItem("authWay",t),i.authFn(t)});var r=!1;$(".btn-spin").on("click",function(){return d?0==a?void i.myAlertFn("No lottery ticket yet. Share and invite more <br/>friends to get the tickets!"):void(r||(r=!0,Interface.fn.playApi(function(t){console.log("playApi",t);var e=t.data.itemName,o="";o=e.indexOf("10000")>-1?1:e.indexOf("20000")>-1?2:3,i.drawAni(o,function(){setTimeout(function(){i.showAwardPop("draw",{code:t.data.code,itemName:A[o].enname,img:A[o].img}),r=!1},500),i.viewUserInfo()})},function(t){i.errFn(t),r=!1}))):void x("auth")}),$(".btn-award").on("click",function(){return d?i.noAward?void i.myAlertFn("No awards from the lottery yet. <br/>Share the link to get a ticket and spin!"):void x("awardList"):void x("auth")}),$(".btn-rule").on("click",function(){x("rule")});var s=!1;$(".share-btn").on("click",function(){if(!d)return void x("auth");if(!s){s=!0;var t=$(this).attr("data-type");$("#"+t).click(),c||Interface.fn.shareApi(function(t){console.log("shareApi",t),s=!1,i.viewUserInfo()},function(t){i.errFn(t),s=!1})}}),$(".xing-bg .bx").on("click",function(){var t=1*$(this).attr("data-status"),e=$(this).attr("data-id");if(0==t)return void i.myAlertFn2("Stay Tuned!");var o=C[e];i.showAwardPop("common",{code:o.code,itemName:o.enname,img:o.img,id:e}),$(this).attr("data-status",2)}),$(".copy-parent").on("click",".copy-btn",function(){var t=$(this).attr("data-code");$("#linkWrap").attr("data-clipboard-text",t),$("#linkWrap").click()}),$("#linkWrap").on("click",function(){var t=new Clipboard("#linkWrap");t.on("success",function(e){i.myAlertFn2("Copy succeeded!"),e.clearSelection(),t.destroy()}),t.on("error",function(){i.myAlertFn2("Copy\xa0failed,\xa0<br/>please\xa0select\xa0copy\xa0manually!\xa0")})});var l=!1;$(".btn-support").on("click",function(){return d?(localStorage.removeItem("ktBtn"),o==n?void i.myAlertFn("You cannot support yourself.",function(){i.backMasterPage()}):void(l||(l=!0,Interface.fn.helpApi(n,function(t){console.log("helpApi",t),i.myAlertFn("Thanks for your support!"),l=!1},function(t){i.errFn(t),l=!1})))):(x("auth"),void localStorage.setItem("ktBtn","auth"))}),$(".btn-too").on("click",function(){i.backMasterPage()}),$(".btn-pullmore").on("click",function(){if(!d)return void x("auth");var t=localStorage.getItem("authWay");"facebook"==t?$("#Jfacebook").click():$("#Jtwitter").click()}),$(".jjqd").on("click",function(){i.myAlertFn2("Stay Tuned!")}),$(".v-btn").on("click",function(){e(),$(".pop-live .live-box").html('<iframe width="1280" height="720" src="https://www.youtube.com/embed/0LM8nUbFOow" title="EVE Echoes Voyage Ceremony Livestream 2022" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>'),x("live")})},drawIndex:0,timer:null,drawAni:function(t,e){var o=this;o.timer=setInterval(function(){o.drawIndex++,$(".j-drawList .award").each(function(n,a){var i=1*$(a).attr("data-pos");i++,3==i&&(i=0),$(a).attr("data-pos",i),o.drawIndex>=20&&0==i&&$(".j-drawList .award[data-pos='0']").attr("data-type")==t&&(o.drawIndex=0,clearInterval(o.timer),o.timer=null,e&&e())})},100)},windowAll:function(){function t(t){for(var e in n)t>=n[e]&&v($(".nav_dh a[data-position]").eq(e));t>0?$(".topbar").addClass("fixed"):$(".topbar").removeClass("fixed")}var e=$(window).scrollTop(),o=$(".topbar").height(),n=[$("[data-md='0']").offset().top,$("[data-md='1']").offset().top-o,$("[data-md='2']").offset().top-o,$("[data-md='3']").offset().top-o];t(e),$(window).on("scroll",function(){e=$(window).scrollTop(),o=$(".topbar").height(),n=[$("[data-md='0']").offset().top,$("[data-md='1']").offset().top-o,$("[data-md='2']").offset().top-o,$("[data-md='3']").offset().top-o],t(e)}),$("[data-position]").on("click",function(){var t=$(this).attr("data-position"),e=$("[data-md="+t+"]").offset().top;o=$(".topbar").height(),0==t?$("body,html").animate({scrollTop:e},500):$("body,html").animate({scrollTop:e-80},500)})},openShare:function(){$("#Jfacebook").on("click",function(){var t=window.location.origin+window.location.pathname;o&&(p.link=t.indexOf("index.html")>-1?t+"?page_key="+o:t+"index.html?page_key="+o),s&&(p.link=t.indexOf("index.html")>-1?t+"?page_key="+n:t+"index.html?page_key="+n),window.open("https://www.facebook.com/sharer/sharer.php?u="+encodeURIComponent(p.link)+"&picture="+encodeURIComponent(p.imgurl)+"&description="+encodeURIComponent(p.desc)+"&title="+encodeURIComponent(p.title)+"&display=popup&ref=plugin&src=share_button","facebook","height=500, width=750, top="+($(window).height()/2-250)+", left="+(document.body.offsetWidth/2-375)+", toolbar=no, menubar=no, scrollbars=no, resizable=no,location=no, status=no")}),$("#Jtwitter").on("click",function(){var t=window.location.origin+window.location.pathname;o&&(p.link=t.indexOf("index.html")>-1?t+"?page_key="+o:t+"index.html?page_key="+o),s&&(p.link=t.indexOf("index.html")>-1?t+"?page_key="+n:t+"index.html?page_key="+n);var e="https://twitter.com/share?url="+encodeURIComponent(p.link)+"&text="+encodeURIComponent(p.desc);window.open(e,"twiiter","height=300, width=600, top="+($(window).height()/2-250)+", left="+(document.body.offsetWidth/2-375)+", toolbar=no, menubar=no, scrollbars=no, resizable=no,location=no, status=no")})},showAwardPop:function(t,e){"draw"==t?($(".j-awardtit").text("Congrats! You've won the award!"),$(".close-award").attr("data-id","")):($(".j-awardtit").text("redeem code"),$(".close-award").attr("data-id",e.id)),$(".j-award-img").attr("src",e.img),$(".j-award-name").text(e.itemName),$(".j-award-code").val(e.code),$(".pop-award .copy-btn").attr("data-code",e.code),x("award")},callback:null,myAlertFn:function(t,e){$(".pop-myAlertB .txt").html(t),e&&(this.callback=e),x("myAlertB")},myAlertFn2:function(t,e){$(".pop-myAlertS .txt").html(t),e&&(this.callback=e),x("myAlertS")},closePop:function(){var t=this;$(".pop .mask").on("click",function(){var e=$(this).parent().find(".close-pop").attr("data-dom"),o=$(this).parent().find(".close-pop").attr("data-id");o&&$(".xing-bg .bx[data-id="+o+"]").attr("data-status",1),t.callback&&(t.callback(),t.callback=null),e?y(e):y()}),$(".close-pop").on("click",function(){var e=$(this).attr("data-dom"),o=$(this).attr("data-id");o&&$(".xing-bg .bx[data-id="+o+"]").attr("data-status",1),t.callback&&(t.callback(),t.callback=null),e?y(e):y()})},errFn:function(t){var e=this,o=t.msg;o.indexOf("token")>-1||o.indexOf("\u672a\u767b\u5f55")>-1?($.cookie("token",null,{expires:-1,path:"/"}),$.cookie("uuid",null,{expires:-1,path:"/"}),d="",l=""):e.myAlertFn(o.indexOf("\u62bd\u5956\u6b21\u6570\u4e0d\u8db3")>-1?"No lottery ticket yet. Share and invite more <br/>friends to get the tickets!":o.indexOf("\u52a9\u529b\u6b21\u6570\u5df2\u8fbe\u5230\u4e0a\u9650")>-1?"Oops! You've ran out of chances of supporting.":o.indexOf("\u4e0d\u53ef\u53cd\u590d\u52a9\u529b")>-1?"You've already supported them.":o.indexOf("\u4e0d\u80fd\u4e3a\u81ea\u5df1\u52a9\u529b")>-1?"You cannot support yourself.":o.indexOf("\u672a\u77e5\u9519\u8bef")>-1?"Network error.":"Network error.")},errFn2:function(t){var e=this;console.log("data",t),-1!=t.msg.indexOf("invalid")?authLogin.go():"\u65e0\u6548\u7684Code\uff1a"==t.msg?authLogin.go():-1!=t.msg.toLowerCase().indexOf("code")?authLogin.go():-1!=t.msg.toLowerCase().indexOf("req_id")?authLogin.go():-1!=t.msg.toLowerCase().indexOf("\u4fe1\u606f\u5f02\u5e38")?authLogin.go():-1!=t.msg.toLowerCase().indexOf("failed")?authLogin.go():-1!=t.msg.toLowerCase().indexOf("error")?authLogin.go():-1!=t.msg.toLowerCase().indexOf("\u5931\u8d25")?authLogin.go():e.myAlertFn(msg)},setCookies:function(t){var e=this,o=2592e6,n=new Date;n.setTime(n.getTime()+o),$.cookie("token",t.data.token,{expires:n,path:"/"}),$.cookie("uuid",t.data.uuid,{expires:n,path:"/"}),l=$.cookie("uuid"),d=$.cookie("token"),e.urlReplace()},urlReplace:function(){var t=window.location.origin+window.location.pathname,e=t;n&&(e=t+"?page_key="+n),window.history.pushState(null,null,e)},shareLoginReport:function(){},clearCookie:function(){$.cookie("token",null,{expires:-1,path:"/"}),$.cookie("uuid",null,{expires:-1,path:"/"}),d="",l=""},countTime:function(){var t=new Date,e=t.getTime(),o="2022/08/19 08:00:00",n=new Date(o),a=n.getTime(),i=a-e,r=0,c=0,s=0,d=0;i>=0&&(r=Math.floor(i/1e3/60/60/24),c=Math.floor(i/1e3/60/60%24),s=Math.floor(i/1e3/60%60),d=Math.floor(i/1e3%60)),(c>0||s>0||d>0)&&(r+=1),$(".p1-num").text(r)},videoAlertFn:function(t,e){var o=this;if(!t)return void o.myAlertFn2("Stay Tuned!");var n='<div class="myAlert myAlert-video">                <div class="mask myAlert-mask"></div>                <div class="myAlert-con-video myAlert-con">                    <video class="video-show" src="'+t+'" controls="controls" autoplay="autoplay"></video>                     <a href="javascript:;" title="close" class="myAlert-close myAlert-close-video"></a>                </div>            </div>';$("body").append(n),$(".video-show")[0].play(),$(".myAlert-close, .myAlert-mask").on("click",function(){$(".myAlert").remove(),e&&e()})},swiperAll:function(){new Swiper(".infoSwp",{slidesPerView:1,observer:!0,observeParents:!0,nextButton:".infoSwp-next",prevButton:".infoSwp-prev",onlyExternal:!0,pagination:".infoSwp-pagination",paginationClickable:!0})}};_.init(),window.drawTest=_.drawAni});